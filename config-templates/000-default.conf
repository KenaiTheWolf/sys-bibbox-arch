<VirtualHost *:80>
        ServerName silicolabv4.bibbox.org
        ProxyRequests           Off
        ProxyPreserveHost       On
       
        ProxyPass               /api/       http://bibbox-sys-commander-backend:5000/api/
        ProxyPassReverse        /api/       http://bibbox-sys-commander-backend:5000/api/


        # working 50%
        RewriteEngine on

        # SSLProxyEngine on
        # ProxyWebsocketFallbackToProxyHttp Off

        RewriteCond %{HTTP:Upgrade}  websocket [NC]
        RewriteRule             /socket.io/(.*) ws://bibbox-sys-commander-backend:5000/socket.io/$1 [P,L]
        ProxyPass               /socket.io      ws://bibbox-sys-commander-backend:5000/socket.io
        ProxyPassReverse        /socket.io      ws://bibbox-sys-commander-backend:5000/socket.io

        DocumentRoot /var/www/html/sys-bibbox-client
        <Directory /var/www/html/sys-bibbox-client>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride None
                Require all granted


                RewriteEngine on
                
                # Don't rewrite files or directories
                RewriteCond %{REQUEST_FILENAME} -f [OR]
                RewriteCond %{REQUEST_FILENAME} -d
                RewriteRule ^ - [L]

                # Rewrite everything else to index.html to allow HTML5 state links
                RewriteRule ^ index.html [L]
        </Directory>



</VirtualHost>

# for testing, could be removed in final product
<VirtualHost *:80>
        ServerName api.silicolabv4.bibbox.org

        ProxyPass               /       http://bibbox-sys-commander-backend:5000/
        ProxyPassReverse        /       http://bibbox-sys-commander-backend:5000/

        ProxyRequests           Off
        ProxyPreserveHost       On

</VirtualHost>
